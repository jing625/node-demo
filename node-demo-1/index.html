<!DOCTYPE html>
<html lang="zh-Hans">

<head>
    <meta charset="UTF-8">
    <title>我的页面</title>
    <link rel="stylesheet" href="./style.css">
</head>

<body>
    <h5>你的账户余额是
        <span id="amount">&&&amount&&&</span>
    </h5>
    <button id="button">打钱</button>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script>



        button.addEventListener('click', (e) => {
            $.ajax({
                url: "http://127.0.0.1:8888/pay",
                dataType: "jsonp",
                success: function (response) {
                    if (response === 'success') {
                        amount.innerText = amount.innerText - 1
                    }
                }
            })
        })



        //     let script = document.createElement('script')
        //     let functionName = 'frank'+ parseInt(Math.random()*100000,10)
        //     window[functionName] =  function(result){
        //     if(result === 'success'){
        //         amount.innerText = amount.innerText - 1
        //     }
        //     else{}
        // }
        //     script.src = 'http://127.0.0.1:8888/pay?callback=' + functionName
        //     document.body.appendChild(script)
        //     script.onload = function(e){
        //         e.currentTarget.remove()
        //         delete window[functionName]
        //     }
        //     script.onerror = function(){
        //         alert('fail')
        //         e.currentTarget.remove()
        //         delete window[functionName]
        //     }
        // })


        //     let image = document.createElement('img')
        //     image.src = '/pay'
        //     image.onload = function () {
        //         alert('打钱成功')
        //         amount.innerText = amount.innerText - 1
        //     }
        //     image.onerror = function () {
        //         alert('打钱失败')
        //     }
        // })
    </script>
</body>

</html>